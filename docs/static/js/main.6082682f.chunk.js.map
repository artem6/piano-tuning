{"version":3,"sources":["components/chart.tsx","utils/keys.ts","components/piano.tsx","config.ts","utils/browserAudio.ts","utils/constants.ts","utils/extractHarmonics.ts","utils/findPeaks.ts","utils/predictHarmonics.ts","utils/twoWayMismatchAlgo.ts","utils/useKeyboard.ts","utils/deepCopy.ts","utils/random.ts","utils/entropy.ts","utils/colorGradient.ts","utils/playNote.ts","utils/useVisibility.ts","utils/storageService.ts","utils/autocorrelation.ts","utils/jsonIO.ts","utils/stat.ts","App.tsx","utils/usePolling.ts","utils/useAnimate.ts","utils/zScore.ts","reportWebVitals.ts","index.tsx","components/piano.module.css"],"names":["useCanvasChart","props","canvasRef","useRef","canvasContextRef","width","height","domain","x1","y1","x2","y2","scaleX","pos","Error","scaleY","getCanvasContext","current","getContext","setDomain","newDomain","clear","ctx","clearRect","line","color","strokeStyle","beginPath","moveTo","lineTo","stroke","rect","fillStyle","fillRect","circle","center","radius","arc","x","y","Math","PI","text","start","font","fillText","CanvasChart","ref","style","border","KEYS","key","octave","idx","sharp","hz","name","forEach","pow","COLORS","SHIFTS","Piano","left","whiteKeys","blackKeys","keyNumbers","notes","keyDeets","keyPos","shift","getKeyDeets","console","warn","push","textAnchor","pointerEvents","isPressed","find","n","keyRect","rx","onClick","keyStyles","className","styles","ebony","ivory","lit","filter","Boolean","join","data-ref","configValues","local","sampleRate","fftSize","minDecibels","maxDecibels","currentEnv","config","env","BrowserAudio","audioContext","analyser","freqDataArray","timeDataArray","stepSize","this","creatContextAndAnalyser","navigator","getUserMedia","audio","stream","createMediaStreamSource","connect","err","error","AudioContext","createAnalyser","bufferLength","Uint8Array","getByteFrequencyData","getByteTimeDomainData","CENTS100","CENTS50","CENTS1","approximateMissingHarmonics","peaks","length","getHarmonicValue","stack","dist","next","prior","prior1","prior2","diff","next1","next2","amplitude","peak","findPeaks","dataArr","boundary","i","threshhold","a","b","c","predictHarmonic","fq","coeff","calcFq","sqrt","generateHarmonics","count","findClosestPeak","target","minPeak","minDist","minAmp","errorRange","abs","findFundamentalFqUsingTwoWayMismatch","lowFq","highFq","targetHarmonics","harmonics","offset","map","h","prediction","possibleHarmonics","maxAmplitude","errors1","harmonic","totalErr","closest","errors2","errors","maxErr","twoWayMismatchAlgo","predictionPeaks","maxPeak","reduce","peakCenterFq","e","callbacks","onKey","evt","tagName","toLocaleLowerCase","indexOf","metaKey","altKey","shiftKey","ctrlKey","cb","document","addEventListener","useKeyboard","filters","options","useEffect","filteredCb","pressType","filterSet","Set","splitFilter","toLowerCase","replace","split","s","trim","meta","alt","ctrl","k","has","type","callbackWithFilters","deepCopy","obj","undefined","JSON","parse","stringify","randomInt","max","floor","random","generateOverlap","decimal","lower","higher","num","den","iter","fraction","l","acceptableIntervals","4","7","12","24","compareKeys","temp","firstPeak","ratio","low","high","ampA","ampB","fA","fB","offsetNote","note","fundamentalFq","fundamentalFqTWM","fundamentalFqAutocorr","minimizeKeyError","targetKey","errorFunc","lastError","lastTune","flopped","itter","testTune","testError","minimizeOctaveInPlace","keys","findTotalEntropy","j","hex","isNaN","round","min","charAt","substring","convertToRGB","parseInt","playNote","duration","context","o","createOscillator","frequency","value","g","createGain","gain","exponentialRampToValueAtTime","currentTime","destination","stop","setTimeout","close","useVisibility","useState","hidden","visible","setVisible","listener","window","removeEventListener","memoryStore","USE_LOCAL_STORE","localStorage","LOCAL_STORE_KEY","VALUE_EXPIRATION","lastExpirationCheck","getStore","dataStr","getItem","setStore","setItem","data","storageService","set","expiration","store","Date","now","get","checkForExpired","Object","autoCorrelate","buffer","minFq","maxFq","minK","maxK","ceil","bestR","worstR","bestK","sum","v1","v2","r","findFundamentalFqUsingAutocorrelation","timeData","autocorrelation","autoPeaks","autoPeaksFq","fq1","fq2","largestPeakFq","largestPeakAmp","downloadObjectAsJson","exportObj","exportName","encodeURIComponent","downloadAnchorNode","createElement","setAttribute","body","appendChild","click","remove","uploadJsonProps","onChange","files","file","reader","FileReader","onload","result","readAsText","mean","list","total","highest","recordedHarmonics","tunedHarmonics","colorGradient","colorStart","colorEnd","colorCount","rgb","end","len","alpha","saida","generateGradient","defaultSettings","mode","noteSounds","tuning","curve","transition","auto","hiddenCharts","App","audioRef","lastValues","autoChange","volume","lastReset","settingsRef","pianoKeyRef","pianoKey","_setPianoKey","setPianoKey","val","interval","timeout","active","polling","clearTimeout","usePolling","_rerender","rerender","keyErrorStyles","keyErrors","currKey","normErr","fill","fn","chartWidth","innerWidth","chartHeight","fftChart","focusedFftChart","predictionChart","autocorrelationChart","harmonicsChart","tunningCurveChart","chartVisible","toggleChart","splice","selectedKeyDef","tunedFundamentalFq","recorededFundamentalFq","harmonicsRecorded","harmonicsTuned","fqData","getFrequencyData","getTimeData","bucketWidth","zScore","samples","lag","signals","sumArr","sum2diffArr","binArr","firstSampleIdx","lastSampleIdx","bin","avg","sum2diff","std","ZScoreBoundary","distBetweenPeaks","medianDistance","p","adjustmentFactor","closestPeak","currentFq","extractHarmonicsForKey","targetFq","score","precision","step","lastFq","highestFq","amplitudeSum","ittr","nullCount","matches","match","pop","extractHarmonics","recordHarmonicsForKey","extracted","curNote","nextNote","weight","breakLoop","loop","requestAnimationFrame","background","margin","overflowX","overflowY","generateTunedUsingNoCurve","A440","currOctave","generateTunedUsingFifths","minErr","log","startKey","generateTunedUsingTotalEntropy","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById","module","exports"],"mappings":"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","file":"static/js/main.6082682f.chunk.js","sourcesContent":["import { useRef } from 'react';\n\ninterface Point {\n  x: number;\n  y: number;\n}\n\ninterface Vector {\n  x1: number;\n  x2: number;\n  y1: number;\n  y2: number;\n}\n\ninterface CanvasChartProps {\n  canvasRef?: any;\n  width?: number;\n  height?: number;\n  domain?: Vector;\n}\n\nexport const useCanvasChart = (props?: CanvasChartProps) => {\n  const canvasRef = useRef<any>();\n  const canvasContextRef = useRef<CanvasRenderingContext2D>();\n  let { width, height, domain } = props || {};\n  if (!width) width = 1024;\n  if (!height) height = 300;\n  if (!domain) domain = { x1: 0, y1: 0, x2: width, y2: height };\n\n  const scaleX = (pos: number) => {\n    if (!domain || !width) throw new Error();\n    return ((pos - domain.x1) / (domain.x2 - domain.x1)) * width;\n  };\n  const scaleY = (pos: number) => {\n    if (!domain || !height) throw new Error();\n    return ((pos - domain.y1) / (domain.y2 - domain.y1)) * height;\n  };\n\n  const getCanvasContext = () => {\n    if (!canvasContextRef.current && canvasRef.current) canvasContextRef.current = canvasRef.current.getContext('2d');\n    return canvasContextRef.current;\n  };\n\n  return {\n    canvasRef,\n    width,\n    height,\n    getCanvasContext,\n    setDomain: (newDomain: Vector) => {\n      domain = newDomain;\n    },\n    clear: () => {\n      const ctx = getCanvasContext();\n      if (!ctx || !width || !height) return;\n      ctx.clearRect(0, 0, width, height);\n    },\n    line: (line: Vector, color = 'gray') => {\n      const ctx = getCanvasContext();\n      if (!ctx) return;\n      ctx.strokeStyle = color;\n      ctx.beginPath();\n      ctx.moveTo(scaleX(line.x1), scaleY(line.y1));\n      ctx.lineTo(scaleX(line.x2), scaleY(line.y2));\n      ctx.stroke();\n    },\n    rect: (rect: Vector, color = 'gray') => {\n      const ctx = getCanvasContext();\n      if (!ctx) return;\n      ctx.fillStyle = color;\n      ctx.fillRect(\n        scaleX(rect.x1),\n        scaleY(rect.y1),\n        scaleX(rect.x2) - scaleX(rect.x1),\n        scaleY(rect.y2) - scaleY(rect.y1),\n      );\n    },\n    circle: (center: Point, radius = 5, color = 'gray') => {\n      const ctx = getCanvasContext();\n      if (!ctx) return;\n      ctx.strokeStyle = color;\n      ctx.beginPath();\n      ctx.arc(scaleX(center.x), scaleY(center.y), radius, 0, 2 * Math.PI);\n      ctx.stroke();\n    },\n    text: (start: Point, text: string, color = 'gray', font = '8px Arial') => {\n      const ctx = getCanvasContext();\n      if (!ctx) return;\n      ctx.fillStyle = color;\n      ctx.font = font;\n\n      ctx.fillText(text, scaleX(start.x), scaleY(start.y));\n    },\n  };\n};\n\nexport const CanvasChart = ({ width, height, canvasRef }: CanvasChartProps) => {\n  return <canvas ref={canvasRef} width={width} height={height} style={{ border: '1px dashed gray' }} />;\n};\n","export interface PianoKey {\n  pos: number;\n  hz: number;\n  name: string;\n  idx: number;\n  key: 'A' | 'B' | 'C' | 'D' | 'E' | 'F' | 'G';\n  sharp: boolean;\n  octave: number;\n}\n\n// prettier-ignore\nexport const KEYS: PianoKey[] = [\n  { pos: 1, key: 'A', octave: 0, idx: 0, sharp: false, hz: 27.5, name: \"A0 Double Pedal A\", },\n  { pos: 2, key: 'A', octave: 0, idx: 0, sharp: true, hz: 29.1352, name: \"A♯0/B♭0\", },\n  { pos: 3, key: 'B', octave: 0, idx: 1, sharp: false, hz: 30.8677, name: \"B0\", },\n  { pos: 4, key: 'C', octave: 1, idx: 2, sharp: false, hz: 32.7032, name: \"C1 Pedal C\", },\n  { pos: 5, key: 'C', octave: 1, idx: 2, sharp: true, hz: 34.6478, name: \"C♯1/D♭1\", },\n  { pos: 6, key: 'D', octave: 1, idx: 3, sharp: false, hz: 36.7081, name: \"D1\", },\n  { pos: 7, key: 'D', octave: 1, idx: 3, sharp: true, hz: 38.8909, name: \"D♯1/E♭1\", },\n  { pos: 8, key: 'E', octave: 1, idx: 4, sharp: false, hz: 41.2034, name: \"E1\", },\n  { pos: 9, key: 'F', octave: 1, idx: 5, sharp: false, hz: 43.6535, name: \"F1\", },\n  { pos: 10, key: 'F', octave: 1, idx: 5, sharp: true, hz: 46.2493, name: \"F♯1/G♭1\", },\n  { pos: 11, key: 'G', octave: 1, idx: 6, sharp: false, hz: 48.9994, name: \"G1\", },\n  { pos: 12, key: 'G', octave: 1, idx: 6, sharp: true, hz: 51.9131, name: \"G♯1/A♭1\", },\n  { pos: 13, key: 'A', octave: 1, idx: 7, sharp: false, hz: 55.0, name: \"A1\", },\n  { pos: 14, key: 'A', octave: 1, idx: 7, sharp: true, hz: 58.2705, name: \"A♯1/B♭1\", },\n  { pos: 15, key: 'B', octave: 1, idx: 8, sharp: false, hz: 61.7354, name: \"B1\", },\n  { pos: 16, key: 'C', octave: 2, idx: 9, sharp: false, hz: 65.4064, name: \"C2 Deep C\", },\n  { pos: 17, key: 'C', octave: 2, idx: 9, sharp: true, hz: 69.2957, name: \"C♯2/D♭2\", },\n  { pos: 18, key: 'D', octave: 2, idx: 10, sharp: false, hz: 73.4162, name: \"D2\", },\n  { pos: 19, key: 'D', octave: 2, idx: 10, sharp: true, hz: 77.7817, name: \"D♯2/E♭2\", },\n  { pos: 20, key: 'E', octave: 2, idx: 11, sharp: false, hz: 82.4069, name: \"E2\", },\n  { pos: 21, key: 'F', octave: 2, idx: 12, sharp: false, hz: 87.3071, name: \"F2\", },\n  { pos: 22, key: 'F', octave: 2, idx: 12, sharp: true, hz: 92.4986, name: \"F♯2/G♭2\", },\n  { pos: 23, key: 'G', octave: 2, idx: 13, sharp: false, hz: 97.9989, name: \"G2\", },\n  { pos: 24, key: 'G', octave: 2, idx: 13, sharp: true, hz: 103.826, name: \"G♯2/A♭2\", },\n  { pos: 25, key: 'A', octave: 2, idx: 14, sharp: false, hz: 110.0, name: \"A2\", },\n  { pos: 26, key: 'A', octave: 2, idx: 14, sharp: true, hz: 116.541, name: \"A♯2/B♭2\", },\n  { pos: 27, key: 'B', octave: 2, idx: 15, sharp: false, hz: 123.471, name: \"B2\", },\n  { pos: 28, key: 'C', octave: 3, idx: 16, sharp: false, hz: 130.813, name: \"C3\", },\n  { pos: 29, key: 'C', octave: 3, idx: 16, sharp: true, hz: 138.591, name: \"C♯3/D♭3\", },\n  { pos: 30, key: 'D', octave: 3, idx: 17, sharp: false, hz: 146.832, name: \"D3\", },\n  { pos: 31, key: 'D', octave: 3, idx: 17, sharp: true, hz: 155.563, name: \"D♯3/E♭3\", },\n  { pos: 32, key: 'E', octave: 3, idx: 18, sharp: false, hz: 164.814, name: \"E3\", },\n  { pos: 33, key: 'F', octave: 3, idx: 19, sharp: false, hz: 174.614, name: \"F3\", },\n  { pos: 34, key: 'F', octave: 3, idx: 19, sharp: true, hz: 184.997, name: \"F♯3/G♭3\", },\n  { pos: 35, key: 'G', octave: 3, idx: 20, sharp: false, hz: 195.998, name: \"G3\", },\n  { pos: 36, key: 'G', octave: 3, idx: 20, sharp: true, hz: 207.652, name: \"G♯3/A♭3\", },\n  { pos: 37, key: 'A', octave: 3, idx: 21, sharp: false, hz: 220.0, name: \"A3\", },\n  { pos: 38, key: 'A', octave: 3, idx: 21, sharp: true, hz: 233.082, name: \"A♯3/B♭3\", },\n  { pos: 39, key: 'B', octave: 3, idx: 22, sharp: false, hz: 246.942, name: \"B3\", },\n  { pos: 40, key: 'C', octave: 4, idx: 23, sharp: false, hz: 261.626, name: \"C4 Middle C\", },\n  { pos: 41, key: 'C', octave: 4, idx: 23, sharp: true, hz: 277.183, name: \"C♯4/D♭4\", },\n  { pos: 42, key: 'D', octave: 4, idx: 24, sharp: false, hz: 293.665, name: \"D4\", },\n  { pos: 43, key: 'D', octave: 4, idx: 24, sharp: true, hz: 311.127, name: \"D♯4/E♭4\", },\n  { pos: 44, key: 'E', octave: 4, idx: 25, sharp: false, hz: 329.628, name: \"E4\", },\n  { pos: 45, key: 'F', octave: 4, idx: 26, sharp: false, hz: 349.228, name: \"F4\", },\n  { pos: 46, key: 'F', octave: 4, idx: 26, sharp: true, hz: 369.994, name: \"F♯4/G♭4\", },\n  { pos: 47, key: 'G', octave: 4, idx: 27, sharp: false, hz: 391.995, name: \"G4\", },\n  { pos: 48, key: 'G', octave: 4, idx: 27, sharp: true, hz: 415.305, name: \"G♯4/A♭4\", },\n  { pos: 49, key: 'A', octave: 4, idx: 28, sharp: false, hz: 440.0, name: \"A4 A440\", },\n  { pos: 50, key: 'A', octave: 4, idx: 28, sharp: true, hz: 466.164, name: \"A♯4/B♭4\", },\n  { pos: 51, key: 'B', octave: 4, idx: 29, sharp: false, hz: 493.883, name: \"B4\", },\n  { pos: 52, key: 'C', octave: 5, idx: 30, sharp: false, hz: 523.251, name: \"C5 Tenor C\", },\n  { pos: 53, key: 'C', octave: 5, idx: 30, sharp: true, hz: 554.365, name: \"C♯5/D♭5\", },\n  { pos: 54, key: 'D', octave: 5, idx: 31, sharp: false, hz: 587.33, name: \"D5\", },\n  { pos: 55, key: 'D', octave: 5, idx: 31, sharp: true, hz: 622.254, name: \"D♯5/E♭5\", },\n  { pos: 56, key: 'E', octave: 5, idx: 32, sharp: false, hz: 659.255, name: \"E5\", },\n  { pos: 57, key: 'F', octave: 5, idx: 33, sharp: false, hz: 698.456, name: \"F5\", },\n  { pos: 58, key: 'F', octave: 5, idx: 33, sharp: true, hz: 739.989, name: \"F♯5/G♭5\", },\n  { pos: 59, key: 'G', octave: 5, idx: 34, sharp: false, hz: 783.991, name: \"G5\", },\n  { pos: 60, key: 'G', octave: 5, idx: 34, sharp: true, hz: 830.609, name: \"G♯5/A♭5\", },\n  { pos: 61, key: 'A', octave: 5, idx: 35, sharp: false, hz: 880.0, name: \"A5\", },\n  { pos: 62, key: 'A', octave: 5, idx: 35, sharp: true, hz: 932.328, name: \"A♯5/B♭5\", },\n  { pos: 63, key: 'B', octave: 5, idx: 36, sharp: false, hz: 987.767, name: \"B5\", },\n  { pos: 64, key: 'C', octave: 6, idx: 37, sharp: false, hz: 1046.5, name: \"C6 Soprano C(High C)\", },\n  { pos: 65, key: 'C', octave: 6, idx: 37, sharp: true, hz: 1108.73, name: \"C♯6/D♭6\", },\n  { pos: 66, key: 'D', octave: 6, idx: 38, sharp: false, hz: 1174.66, name: \"D6\", },\n  { pos: 67, key: 'D', octave: 6, idx: 38, sharp: true, hz: 1244.51, name: \"D♯6/E♭6\", },\n  { pos: 68, key: 'E', octave: 6, idx: 39, sharp: false, hz: 1318.51, name: \"E6\", },\n  { pos: 69, key: 'F', octave: 6, idx: 40, sharp: false, hz: 1396.91, name: \"F6\", },\n  { pos: 70, key: 'F', octave: 6, idx: 40, sharp: true, hz: 1479.98, name: \"F♯6/G♭6\", },\n  { pos: 71, key: 'G', octave: 6, idx: 41, sharp: false, hz: 1567.98, name: \"G6\", },\n  { pos: 72, key: 'G', octave: 6, idx: 41, sharp: true, hz: 1661.22, name: \"G♯6/A♭6\", },\n  { pos: 73, key: 'A', octave: 6, idx: 42, sharp: false, hz: 1760.0, name: \"A6\", },\n  { pos: 74, key: 'A', octave: 6, idx: 42, sharp: true, hz: 1864.66, name: \"A♯6/B♭6\", },\n  { pos: 75, key: 'B', octave: 6, idx: 43, sharp: false, hz: 1975.53, name: \"B6\", },\n  { pos: 76, key: 'C', octave: 7, idx: 44, sharp: false, hz: 2093.0, name: \"C7 Double high C\", },\n  { pos: 77, key: 'C', octave: 7, idx: 44, sharp: true, hz: 2217.46, name: \"C♯7/D♭7\", },\n  { pos: 78, key: 'D', octave: 7, idx: 45, sharp: false, hz: 2349.32, name: \"D7\", },\n  { pos: 79, key: 'D', octave: 7, idx: 45, sharp: true, hz: 2489.02, name: \"D♯7/E♭7\", },\n  { pos: 80, key: 'E', octave: 7, idx: 46, sharp: false, hz: 2637.02, name: \"E7\", },\n  { pos: 81, key: 'F', octave: 7, idx: 47, sharp: false, hz: 2793.83, name: \"F7\", },\n  { pos: 82, key: 'F', octave: 7, idx: 47, sharp: true, hz: 2959.96, name: \"F♯7/G♭7\", },\n  { pos: 83, key: 'G', octave: 7, idx: 48, sharp: false, hz: 3135.96, name: \"G7\", },\n  { pos: 84, key: 'G', octave: 7, idx: 48, sharp: true, hz: 3322.44, name: \"G♯7/A♭7\", },\n  { pos: 85, key: 'A', octave: 7, idx: 49, sharp: false, hz: 3520.0, name: \"A7\", },\n  { pos: 86, key: 'A', octave: 7, idx: 49, sharp: true, hz: 3729.31, name: \"A♯7/B♭7\", },\n  { pos: 87, key: 'B', octave: 7, idx: 50, sharp: false, hz: 3951.07, name: \"B7\", },\n  { pos: 88, key: 'C', octave: 8, idx: 51, sharp: false, hz: 4186.01, name: \"C8 Eighth octave\",  }\n];\n\n// more precise frequencies\nKEYS.forEach(key => (key.hz = 27.5 * Math.pow(Math.pow(2, 1 / 12), key.pos - 1)));\n","import React from 'react';\n\nimport { KEYS, PianoKey } from '../utils/keys';\nimport styles from './piano.module.css';\n\nconst COLORS = {\n  EBONY: 'ebony',\n  IVORY: 'ivory',\n};\nconst SHIFTS = {\n  LEFT: 'LEFT',\n  MIDDLE: 'MIDDLE',\n  RIGHT: 'RIGHT',\n};\n\nfunction getKeyDeets(keyPos: number) {\n  const key = keyPos % 12;\n  let shift;\n  let color;\n\n  if (key === 2 || key === 7) {\n    shift = SHIFTS.RIGHT;\n    color = COLORS.EBONY;\n  } else if (key === 5 || key === 10) {\n    shift = SHIFTS.LEFT;\n    color = COLORS.EBONY;\n  } else if (key === 0) {\n    shift = SHIFTS.MIDDLE;\n    color = COLORS.EBONY;\n  } else {\n    shift = null;\n    color = COLORS.IVORY;\n  }\n  return { shift, color };\n}\n\ninterface props {\n  notes?: PianoKey[];\n  onClick?: { (key: number): unknown };\n  keyStyles?: { [key: number]: any };\n}\n\nexport const Piano: React.FC<props> = props => {\n  let left = 30;\n  const whiteKeys: any[] = [];\n  const blackKeys: any[] = [];\n  const keyNumbers: any[] = [];\n\n  const notes = props.notes || [];\n\n  KEYS.forEach(key => {\n    const keyDeets = getKeyDeets(key.pos);\n    let x = left;\n    let height = 125;\n    let width = 22;\n\n    if (keyDeets.color === COLORS.EBONY) {\n      height -= 45;\n      width = 11;\n\n      if (keyDeets.shift === SHIFTS.LEFT) {\n        x = left - 7;\n      } else if (keyDeets.shift === SHIFTS.MIDDLE) {\n        x = left - 5;\n      } else if (keyDeets.shift === SHIFTS.RIGHT) {\n        x = left - 3;\n      } else {\n        console.warn('SHIFT was not set');\n      }\n    } else {\n      left += 22;\n      keyNumbers.push(\n        <text key={key.pos + 'number'} x={x + width / 2} y={10} textAnchor='middle'>\n          {key.pos}\n        </text>,\n      );\n      keyNumbers.push(\n        <text style={{ pointerEvents: 'none' }} key={key.pos + 'key'} x={x + width / 2} y={120} textAnchor='middle'>\n          {key.key}\n        </text>,\n      );\n    }\n\n    const isPressed = !!notes.find(n => n.pos === key.pos);\n\n    const keyRect = (\n      <rect\n        key={key.pos}\n        rx={2}\n        x={x}\n        y={14}\n        width={width}\n        height={height}\n        onClick={() => props.onClick?.(key.pos - 1)}\n        style={props.keyStyles?.[key.pos]}\n        className={[\n          styles.key,\n          keyDeets.color === COLORS.EBONY ? styles.ebony : styles.ivory,\n          isPressed ? styles.lit : '',\n        ]\n          .filter(Boolean)\n          .join(' ')}\n      />\n    );\n\n    if (keyDeets.color === COLORS.EBONY) {\n      blackKeys.push(keyRect);\n    } else {\n      whiteKeys.push(keyRect);\n    }\n  });\n  return (\n    <svg data-ref='piano' width='1200' height='200'>\n      {whiteKeys}\n      {keyNumbers}\n      {blackKeys}\n    </svg>\n  );\n};\n","const configValues = {\n  local: {\n    sampleRate: 44100, // audioContext.sampleRate\n    fftSize: 16384 * 2, // analyser.fftSize = 32 - 16384 - 32768;\n    minDecibels: -90, // analyser.minDecibels = -90;\n    maxDecibels: -10, // analyser.maxDecibels = -10;\n  },\n};\n\ntype ConfigValues = typeof configValues;\nexport type ConfigEnv = keyof ConfigValues;\nexport type ConfigTypes = keyof ConfigValues['local'];\n\nlet currentEnv: ConfigEnv = 'local';\n\nfunction setConfigEnv(env: ConfigEnv) {\n  currentEnv = env;\n  localStorage.setItem('env', env);\n}\n\nconst config = <T extends ConfigTypes>(key: T, env: ConfigEnv = currentEnv): ConfigValues['local'][T] => {\n  return configValues[env][key];\n};\n\nexport default config;\nexport { setConfigEnv };\n","import { useRef } from 'react';\n\ninterface BrowserAudioConfig {\n  fftSize?: number;\n  minDecibels?: number;\n  maxDecibels?: number;\n}\n\nexport class BrowserAudio {\n  audioContext!: AudioContext;\n  analyser!: AnalyserNode;\n\n  sampleRate!: number;\n  fftSize!: number;\n\n  freqDataArray!: Uint8Array;\n  timeDataArray!: Uint8Array;\n  stepSize!: number;\n\n  creatContextAndAnalyser(config?: BrowserAudioConfig) {\n    this.audioContext = new AudioContext();\n    this.analyser = this.audioContext.createAnalyser();\n    this.analyser.fftSize = config?.fftSize || 16384 * 2;\n    this.analyser.minDecibels = config?.minDecibels || -90;\n    this.analyser.maxDecibels = config?.maxDecibels || -10;\n\n    this.sampleRate = this.audioContext.sampleRate;\n    this.fftSize = this.analyser.fftSize;\n    this.stepSize = this.sampleRate / this.fftSize;\n\n    const bufferLength = this.fftSize / 2;\n\n    this.freqDataArray = new Uint8Array(bufferLength);\n    this.timeDataArray = new Uint8Array(bufferLength);\n  }\n\n  constructor(config?: BrowserAudioConfig) {\n    this.creatContextAndAnalyser(config);\n    navigator.getUserMedia(\n      { audio: true },\n      stream => {\n        const audioSource = this.audioContext.createMediaStreamSource(stream);\n        audioSource.connect(this.analyser);\n      },\n      err => {\n        err && console.error(err);\n      },\n    );\n  }\n\n  getFrequencyData() {\n    this.analyser.getByteFrequencyData(this.freqDataArray);\n    return this.freqDataArray;\n  }\n  getTimeData() {\n    this.analyser.getByteTimeDomainData(this.timeDataArray);\n    return this.timeDataArray;\n  }\n}\n\nexport const useBrowserAudio = (props?: BrowserAudioConfig) => {\n  const ref = useRef<BrowserAudio>();\n  if (!ref.current) ref.current = new BrowserAudio(props);\n  return ref.current;\n};\n","export const CENTS100 = Math.pow(2, 1 / 12);\nexport const CENTS50 = (CENTS100 - 1) / 2 + 1;\nexport const CENTS10 = (CENTS100 - 1) / 10 + 1;\nexport const CENTS1 = (CENTS100 - 1) / 100 + 1;\n","import { CENTS50 } from './constants';\nimport { Peak } from './findPeaks';\n\n// given peaks and a fundamental frequency, find all harmonics in those peaks\nexport const extractHarmonics = (peaks: Peak[], fq: number) => {\n  if (!peaks.length) return { score: 0, harmonics: [] };\n  const precision = CENTS50;\n\n  const harmonics: (Peak | null)[] = [];\n  let step = fq;\n  let lastFq = 0;\n  let currentFq = 0;\n\n  const highestFq = peaks[peaks.length - 1].center;\n\n  let amplitudeSum = 0;\n\n  let ittr = 0;\n  let nullCount = 0;\n  while (currentFq * precision < highestFq && ittr++ < 50) {\n    lastFq = currentFq;\n    currentFq += step;\n    if (nullCount >= 5) break;\n\n    // eslint-disable-next-line no-loop-func\n    const matches = peaks.filter(peak => peak.center >= currentFq / precision && peak.center <= currentFq * precision);\n    if (!matches.length) {\n      nullCount++;\n      harmonics.push(null);\n    } else {\n      nullCount = 0;\n      let peak = matches[0];\n      matches.forEach(match => {\n        if (match.amplitude > peak.amplitude) peak = match;\n      });\n      harmonics.push(peak);\n      amplitudeSum += peak.amplitude;\n      step = Math.max(peak.center - lastFq, step);\n    }\n  }\n  while (harmonics[harmonics.length - 1] === null) harmonics.pop();\n\n  const score = amplitudeSum; // + harmonics.filter(Boolean).length * 255;\n  return { score, harmonics };\n};\n\nexport const approximateMissingHarmonics = (peaks: (Peak | null)[]) => {\n  peaks = [...(peaks || [])];\n\n  let data = peaks.filter(Boolean).length;\n  if (data / peaks.length < 0.3) return peaks;\n\n  const getHarmonicValue = (idx: number, stack = 0): number | null => {\n    let center = peaks[idx]?.center || null;\n    if (center) return center;\n    if (stack === 3) return null;\n    const dist = 5;\n    if (!peaks[idx - 1]) {\n      const next1 = getHarmonicValue(idx + 1, stack + 1);\n      const next2 = getHarmonicValue(idx + 1 + dist, stack + 1);\n      if (next1 === null || next2 === null) center = null;\n      else {\n        const diff = (next2 - next1) / dist;\n        // console.log(idx, diff);\n        center = next1 - diff;\n      }\n    } else if (!peaks[idx + 1]) {\n      const prior1 = getHarmonicValue(idx - 1, stack + 1);\n      const prior2 = getHarmonicValue(idx - 1 - dist, stack + 1);\n      if (prior1 === null || prior2 === null) center = null;\n      else {\n        const diff = (prior1 - prior2) / dist;\n        center = prior1 + diff;\n      }\n    } else {\n      const next = getHarmonicValue(idx + 1, stack + 1);\n      const prior = getHarmonicValue(idx - 1, stack + 1);\n      if (next === null || prior === null) center = null;\n      else {\n        center = (next + prior) / 2;\n      }\n    }\n    if (center !== null) peaks[idx] = { center, amplitude: 0 };\n\n    return center;\n  };\n\n  peaks.forEach((peak, idx) => getHarmonicValue(idx));\n  return peaks;\n};\n\nexport const medianSpaceBetweenHarmonics = (peaks: (Peak | null)[]) => {\n  const dist: number[] = [];\n  let last: number | undefined = 0;\n  peaks.forEach(peak => {\n    if (peak?.center && last !== undefined) {\n      dist.push(peak.center - last);\n    }\n    last = peak?.center;\n  });\n  dist.sort();\n  return dist[Math.floor(dist.length / 2)];\n};\n","export interface Peak {\n  center: number;\n  amplitude: number;\n}\n\n// finds the peaks from an FFT\nexport function findPeaks(dataArr: Uint8Array | number[], boundary: number | Uint8Array | number[]): Peak[] {\n  const peaks: { center: number; amplitude: number }[] = [];\n\n  for (let i = 1; i < dataArr.length - 1; i++) {\n    const threshhold = typeof boundary === 'number' ? boundary : boundary[i];\n    // peak detection\n    const a = dataArr[i - 1];\n    const b = dataArr[i];\n    const c = dataArr[i + 1];\n    if (b > threshhold && b >= a && b >= c) {\n      // parabolic interpolation\n      const center = i + (0.5 * (a - c)) / (a - 2 * b + c);\n      const amplitude = b - 0.25 * (center - i) * (a - c);\n      peaks.push({ center, amplitude });\n    }\n  }\n\n  return peaks;\n}\n","import { Peak } from './findPeaks';\n\nexport const predictHarmonic = (fq: number, n: number, coeff: number = 0.00055) => {\n  const calcFq = fq * (n + 1) * Math.sqrt(1 + coeff * n * n);\n  return calcFq;\n};\n\nexport const generateHarmonics = (fq: number, count: number, coeff: number = 0.00055) => {\n  const peaks: Peak[] = [];\n  for (let i = 0; i <= count; i++) {\n    peaks.push({ amplitude: 255 - i * 10, center: predictHarmonic(fq, i, coeff) });\n  }\n  return peaks;\n};\n","import { CENTS50 } from './constants';\nimport { findPeaks, Peak } from './findPeaks';\n\nexport const findClosestPeak = (peaks: Peak[], target: number) => {\n  let minDist: number | null = null;\n  let minAmp = 0;\n  let minPeak: Peak | undefined;\n\n  const errorRange = CENTS50;\n  peaks.forEach(peak => {\n    const dist = Math.abs(target - peak.center);\n    if (minDist === null || dist < minDist / errorRange || (dist < minDist * errorRange && minAmp <= peak.amplitude)) {\n      minDist = dist;\n      minAmp = peak.amplitude;\n      minPeak = peak;\n    }\n  });\n  if (!minPeak) throw new Error();\n  return minPeak;\n};\n\nexport const twoWayMismatchAlgo = (peaks: Peak[], possibleHarmonics: Peak[][]) => {\n  const p = 0.5; // weighting by frequency value?\n  const q = 1.4; // weighting related to magnitude of peaks?\n  const r = 0.5; // scaling related to magnitude of peaks?\n  const rho = 0.33; // weighting of MP (measured to predicted) error\n  // const harmonicWeight = 0.9; // further harmonics are treated as less important\n\n  const maxAmplitude = 255;\n\n  // predicted to measured mismatch\n  const errors1: number[] = [];\n  possibleHarmonics.forEach(harmonic => {\n    let totalErr = 0;\n    harmonic.forEach((peak, idx) => {\n      const closest = findClosestPeak(peaks, peak.center);\n      if (2 > 1) {\n        const dist = Math.abs(closest.center - peak.center) / peak.center;\n        let err = -0.5;\n        if (dist < CENTS50) {\n          err = closest.amplitude / maxAmplitude / dist;\n        }\n        totalErr += err / harmonic.length;\n      } else {\n        // real formula\n        const dist = Math.abs(closest.center - peak.center);\n        const err =\n          dist * Math.pow(closest.center, -p) +\n          (closest.amplitude / maxAmplitude) * (q * dist * Math.pow(closest.center, -p) - r);\n        totalErr += err;\n      }\n    });\n    errors1.push(totalErr);\n  });\n\n  // measured to predicted mismatch\n  const errors2: number[] = [];\n  peaks.forEach((peak, idx) => {\n    possibleHarmonics.forEach((harmonic, idx) => {\n      const closest = findClosestPeak(harmonic, peak.center);\n      errors2[idx] = errors2[idx] || 0;\n\n      if (2 > 1) {\n        const dist = Math.abs(closest.center - peak.center) / closest.center;\n        let err = -0.5 * (peak.amplitude / maxAmplitude); // if the measured peak is small, then don't deduct as much\n        if (dist < CENTS50) {\n          err = peak.amplitude / maxAmplitude / dist;\n        }\n        errors2[idx] += err / peaks.length;\n      } else {\n        // real formula\n        const dist = Math.abs(closest.center - peak.center);\n        const err =\n          dist * Math.pow(peak.center, -p) +\n          (peak.amplitude / maxAmplitude) * (q * dist * Math.pow(peak.center, -p) - r);\n        errors2[idx] += err;\n      }\n    });\n  });\n\n  // combine the two errors\n  const errors: number[] = [];\n  let maxErr = 0;\n  for (let i = 0; i < errors1.length; i++) {\n    errors[i] = errors1[i] + errors2[i] * rho;\n    if (errors[i] > maxErr) maxErr = errors[i];\n  }\n\n  // normalize to 0-1\n  for (let i = 0; i < errors.length; i++) {\n    errors[i] = errors[i] / maxErr;\n  }\n\n  return errors;\n};\n\nexport const findFundamentalFqUsingTwoWayMismatch = ({\n  lowFq,\n  highFq,\n  stepSize,\n  peaks,\n  targetHarmonics,\n}: {\n  lowFq: number;\n  highFq: number;\n  stepSize: number;\n  peaks: Peak[];\n  targetHarmonics: Peak[];\n}) => {\n  try {\n    const harmonics: Peak[][] = [];\n    for (let i = lowFq; i < highFq; i += stepSize) {\n      const offset = i / (targetHarmonics[0]?.center || i);\n      harmonics.push(targetHarmonics.map(h => ({ ...h, center: (h?.center || 0) * offset })));\n    }\n\n    const prediction = twoWayMismatchAlgo(peaks, harmonics);\n    const predictionPeaks = findPeaks(prediction, 0.2);\n    const maxPeak = predictionPeaks.length\n      ? predictionPeaks.reduce((a, b) => (a.amplitude > b.amplitude ? a : b))\n      : null;\n    const peakCenterFq = lowFq + (maxPeak?.center || 0) * stepSize;\n\n    return {\n      prediction,\n      maxPeak,\n      peakCenterFq,\n    };\n  } catch (e) {\n    return { prediction: [], maxPeak: null, peakCenterFq: 0 };\n  }\n};\n","import { useEffect } from 'react';\n\ntype KeyboardCallback = { (evt: KeyboardEvent): unknown };\ninterface KeyOptions {\n  pressType?: ('keyup' | 'keydown' | 'keypress')[];\n}\n\nlet currentKeys = {\n  metaKey: false,\n  altKey: false,\n  shiftKey: false,\n  ctrlKey: false,\n};\n\n// register global listener\nlet callbacks: KeyboardCallback[] = [];\nconst onKey = (evt: KeyboardEvent) => {\n  const target = evt && (evt.target as HTMLInputElement);\n  const tagName = target.tagName.toLocaleLowerCase();\n  if (['input', 'textfield', 'textarea'].indexOf(tagName) > -1) return;\n  currentKeys = {\n    metaKey: evt.metaKey,\n    altKey: evt.altKey,\n    shiftKey: evt.shiftKey,\n    ctrlKey: evt.ctrlKey,\n  };\n\n  callbacks.forEach(cb => cb(evt));\n};\ndocument.addEventListener('keydown', onKey, false);\ndocument.addEventListener('keyup', onKey, false);\ndocument.addEventListener('keypress', onKey, false);\n\n// filter the callback\nconst callbackWithFilters = (\n  filters: string | string[],\n  cb: KeyboardCallback,\n  options: KeyOptions,\n): KeyboardCallback => {\n  if (!filters.length) return cb;\n\n  const pressType = options.pressType || ['keydown'];\n\n  const filterSet = new Set(\n    (typeof filters === 'string' ? [filters] : filters).map(filter => {\n      const splitFilter = filter\n        .toLowerCase()\n        .replace('++', '+plus')\n        .replace('+ +', '+plus')\n        .replace(/^\\+/, 'plus')\n        .split('+')\n        .map(s => s.trim())\n        .map(s => (s === 'plus' ? '+' : s === '' ? ' ' : s));\n\n      let meta = false;\n      let alt = false;\n      let shift = false;\n      let ctrl = false;\n      let key = splitFilter[splitFilter.length - 1];\n      splitFilter.forEach(k => {\n        // meta not on windows\n        if (k === 'meta' || k === 'command' || k === 'cmd') meta = true;\n        else if (k === 'option' || k === 'alt') alt = true;\n        else if (k === 'shift') shift = true;\n        else if (k === 'control' || k === 'ctrl') ctrl = true;\n        else key = k;\n      });\n      return `${meta}+${alt}+${shift}+${ctrl}+${key}`;\n    }),\n  );\n\n  return evt => {\n    const key = `${evt.metaKey}+${evt.altKey}+${evt.shiftKey}+${evt.ctrlKey}+${evt.key}`.toLowerCase();\n    if (filters.length && !filterSet.has(key)) return;\n    if (pressType.indexOf(evt.type as any) === -1) return;\n    cb(evt);\n  };\n};\n\n/*\nuseful key modifiers\n  Alt (option on mac)\n  Shift\n  Control\n  Meta (command on mac, not on windows)\n\nuseful keys\n  ArrowUp\n  ArrowDown\n  ArrowLeft\n  ArrowRight\n  Tab\n  Enter\n  Backspace\n\nnotes\n  watch out for keys that need \"Shift\" to be pressed\n\nexamples\n  \"Shift + +\"\n  \"Shift + ^\"\n  \"Alt + ArrowLeft\"\n  \"ArrowUp\"\n*/\nexport const useKeyboard = (filters: string | string[], cb: KeyboardCallback, options?: KeyOptions) => {\n  useEffect(() => {\n    const filteredCb = callbackWithFilters(filters, cb, { pressType: options?.pressType });\n    callbacks.push(filteredCb);\n    return () => {\n      callbacks = callbacks.filter(c => c !== filteredCb);\n    };\n  }, [filters, cb, options?.pressType]);\n};\n\nexport const getCurrentKeysPressed = () => currentKeys;\n","export function deepCopy<T>(obj: T): T {\n  if (obj === undefined) return obj;\n  return JSON.parse(JSON.stringify(obj));\n}\n","// random between 0 and max - 1\nexport const randomInt = (max: number) => Math.floor(Math.random() * max);\n\nexport const selectOneRandomly = <T>(list: T[]) => list[randomInt(list.length)];\n\nexport const randomizeList = <T>(list: T[]) => {\n  list = [...list];\n  for (let i = 0; i < list.length; i++) {\n    const j = randomInt(list.length - i) + i;\n    const temp = list[i];\n    list[i] = list[j];\n    list[j] = temp;\n  }\n  return list;\n};\n","import { CENTS1 } from './constants';\nimport { deepCopy } from './deepCopy';\nimport { approximateMissingHarmonics } from './extractHarmonics';\nimport { Peak } from './findPeaks';\nimport { KEYS } from './keys';\nimport { randomInt } from './random';\n\nconst cutoff = 20;\n\ninterface KeyData {\n  key: number;\n  fundamentalFq: number;\n  fundamentalFqTWM: number;\n  fundamentalFqAutocorr: number;\n  harmonics: (Peak | null)[];\n}\n\n/*\n  1.25 = third\n  1.5 = fifth\n  2 = octave\n\n  1,   2,   3,   4,   5,   6,   7,   8,   9,   10\n  1.25, 2.5, 3.75,    5, 6.25, 7.5, 8.75,      10\n    1.5,    3,    4.5,     6,     7.5,    9\n       2,        4,        6,        8,        10\n*/\n\nconst fraction = (decimal: number) => {\n  let num = 1;\n  let den = 1;\n  let iter = 0;\n  while (true) {\n    if (iter++ > 1000) throw new Error('not a fraction');\n    if (num / den < decimal) {\n      num++;\n      den = 1;\n    }\n    if (num / den > decimal) {\n      den++;\n    }\n    if (num / den === decimal) break;\n  }\n  return [num, den];\n};\n\nconst generateOverlap = (decimal: number) => {\n  let lower: number[] = [];\n  let higher: number[] = [];\n\n  let [num, den] = fraction(decimal);\n  let l = 0;\n  let h = 0;\n  for (let i = 0; i < 20; i++) {\n    l += num;\n    h += den;\n    lower.push(l - 1);\n    higher.push(h - 1);\n  }\n  return [lower, higher];\n};\n\nconst acceptableIntervals: { [interval: number]: number } = {\n  4: 1.25, // third\n  7: 1.5, // fifth\n  12: 2, // octave\n  24: 4, // 2 * octave\n  // 36: 6, // 3 * octave\n};\n\nexport const compareKeys = (a: KeyData, b: KeyData) => {\n  if (!a || !b) return null;\n  let error: number[] = [];\n\n  if (b.key < a.key) {\n    const temp = a;\n    a = b;\n    b = temp;\n  }\n\n  // if a note doesn't have a harmonic, approximate one using a multiple\n  const firstPeak = a.harmonics[0];\n  if (a.harmonics.length <= 2 && !a.harmonics[1] && firstPeak) {\n    a = { ...a, harmonics: [...a.harmonics] };\n    a.harmonics[1] = { amplitude: firstPeak.amplitude, center: firstPeak.center * 2.01 };\n  }\n\n  const ratio = acceptableIntervals[b.key - a.key];\n  if (!ratio) return null;\n\n  const [low, high] = generateOverlap(ratio);\n\n  // console.log(a, b);\n  // console.log(low, high);\n\n  for (let i = 0; i < low.length; i++) {\n    if (low[i] >= a.harmonics.length) break;\n    if (high[i] >= b.harmonics.length) break;\n    const ampA = a.harmonics[low[i]]?.amplitude || 0;\n    const ampB = b.harmonics[high[i]]?.amplitude || 0;\n    if (ampA < cutoff) break;\n    if (ampB < cutoff) break;\n    let fA = a.harmonics[low[i]]?.center || 0;\n    let fB = b.harmonics[high[i]]?.center || 0;\n    // console.log(fA, fB);\n\n    const offset = Math.abs((fA - fB) / fA) * (ampA / 255) * (ampB / 255);\n    error.push(offset);\n  }\n  if (!error.length) return null;\n  const meanError = error.reduce((a, b) => a + b) / error.length;\n  return meanError / (CENTS1 - 1);\n};\n\nconst offsetNote = <T extends KeyData>(note: T, offset: number) => ({\n  ...note,\n  fundamentalFq: note.fundamentalFq * offset,\n  fundamentalFqTWM: note.fundamentalFqTWM * offset,\n  fundamentalFqAutocorr: note.fundamentalFqAutocorr * offset,\n  harmonics: note.harmonics.map(peak => (peak ? { ...peak, center: peak.center * offset } : peak)),\n});\n\nconst minimizeKeyError = <T extends KeyData>(targetKey: T, errorFunc: { (key: T): number | null }): T => {\n  let offset = CENTS1;\n  let lastError = errorFunc(targetKey);\n  let lastTune = targetKey;\n\n  if (!lastError) return targetKey;\n\n  let flopped = false;\n  let itter = 0;\n  while (Math.abs(1 - offset) > 0.0001 && itter++ < 100) {\n    let testTune = offsetNote(lastTune, offset);\n    // console.log('test', offset, testTune.harmonics[0]?.center);\n    let testError = errorFunc(testTune) || 0;\n    if (testError < lastError) {\n      lastTune = testTune;\n      lastError = testError;\n    } else if (!flopped) {\n      flopped = true;\n      offset = 1 / offset;\n    } else {\n      flopped = false;\n      offset = offset / 2;\n    }\n  }\n  // console.log('minimized', lastError, targetKey.harmonics[0]?.center, lastTune.harmonics[0]?.center);\n\n  return lastTune;\n};\n\nconst minimizeOctaveInPlace = <T extends KeyData>(keys: { [key: number]: T }, start: number) => {\n  for (let key = start + 12; key <= 87; key += 12) {\n    keys[key] = minimizeKeyError(keys[key], targetKey => compareKeys(keys[key - 12], targetKey));\n  }\n  for (let key = start - 12; key >= 0; key -= 12) {\n    keys[key] = minimizeKeyError(keys[key], targetKey => compareKeys(keys[key + 12], targetKey));\n  }\n};\n\nexport const generateTunedUsingFifths = <T extends KeyData>(keys: { [key: number]: T }) => {\n  keys = deepCopy(keys);\n  const A440 = keys[48];\n  keys[48] = offsetNote(A440, 440 / (A440.harmonics[0]?.center || 440));\n\n  // A 48\n  let currOctave = 48;\n  minimizeOctaveInPlace(keys, currOctave);\n\n  // A --> D --> G --> C ...\n  for (let i = 0; i < 11; i++) {\n    if (currOctave < 30) currOctave += 12;\n    // eslint-disable-next-line no-loop-func\n    minimizeKeyError(keys[currOctave - 7], targetKey => compareKeys(keys[currOctave], targetKey));\n    currOctave += -7;\n    minimizeOctaveInPlace(keys, currOctave);\n  }\n\n  return keys;\n};\n\nexport const generateTunedUsingTotalEntropy = <T extends KeyData>(keys: { [key: number]: T }) => {\n  keys = deepCopy(keys);\n  const A440 = keys[48];\n  keys[48] = offsetNote(A440, 440 / (A440.harmonics[0]?.center || 440));\n  let minErr = findTotalEntropy(keys);\n  console.log(minErr);\n\n  for (let i = 0; i < 10; i++) {\n    let startKey = 48;\n    while (startKey !== 48) startKey = randomInt(88);\n\n    let key = startKey + 1;\n    while (key !== startKey) {\n      if (key === 88) key = 0;\n      // eslint-disable-next-line no-loop-func\n      keys[key] = minimizeKeyError(keys[key], targetKey => findTotalEntropy({ ...keys, [key]: targetKey }));\n      key += 1;\n    }\n\n    let totalErr = findTotalEntropy(keys);\n    if (totalErr < minErr) {\n      minErr = totalErr;\n    } else break;\n    console.log(i, minErr);\n  }\n\n  return keys;\n};\n\nexport const generateTunedUsingNoCurve = <T extends KeyData>(keys: { [key: number]: T }) => {\n  keys = deepCopy(keys);\n  for (let i = 0; i < 88; i++) {\n    keys[i].harmonics = approximateMissingHarmonics(keys[i].harmonics);\n    keys[i] = offsetNote(keys[i], KEYS[i].hz / (keys[i].harmonics[0]?.center || KEYS[i].hz));\n  }\n  return keys;\n};\n\nexport const findTotalEntropy = <T extends KeyData>(keys: { [key: number]: T }) => {\n  let totalErr = 0;\n  let count = 0;\n  for (let i = 0; i < 88; i++) {\n    for (let j = i + 1; j < 88; j++) {\n      let err = compareKeys(keys[i], keys[j]);\n      if (err !== null) {\n        totalErr += err;\n        count++;\n      }\n    }\n  }\n  return totalErr / count;\n};\n","type RGB = [number, number, number];\n\nfunction hex(i: number) {\n  var s = '0123456789abcdef';\n  if (i === 0 || isNaN(i)) return '00';\n  i = Math.round(Math.min(Math.max(0, i), 255));\n  return s.charAt((i - (i % 16)) / 16) + s.charAt(i % 16);\n}\n\nfunction convertToHex(rgb: RGB) {\n  return hex(rgb[0]) + hex(rgb[1]) + hex(rgb[2]);\n}\n\nfunction trim(s: string) {\n  return s.charAt(0) === '#' ? s.substring(1, 7) : s;\n}\n\nfunction convertToRGB(hex: string): RGB {\n  const color: RGB = [\n    parseInt(trim(hex).substring(0, 2), 16),\n    parseInt(trim(hex).substring(2, 4), 16),\n    parseInt(trim(hex).substring(4, 6), 16),\n  ];\n  return color;\n}\n\nexport function generateGradient(colorStart: string, colorEnd: string, colorCount: number) {\n  let end = convertToRGB(colorStart);\n  let start = convertToRGB(colorEnd);\n  let len = colorCount;\n  let alpha = 0.0;\n  let saida = [];\n\n  for (let i = 0; i < len; i++) {\n    const c: RGB = [0, 0, 0];\n    alpha += 1.0 / len;\n\n    c[0] = start[0] * alpha + (1 - alpha) * end[0];\n    c[1] = start[1] * alpha + (1 - alpha) * end[1];\n    c[2] = start[2] * alpha + (1 - alpha) * end[2];\n\n    saida.push(convertToHex(c));\n  }\n\n  return saida;\n}\n","import { Peak } from './findPeaks';\n\nexport const playNote = (peaks: (Peak | null)[], duration = 6) => {\n  const context = new AudioContext();\n  peaks.forEach(peak => {\n    if (!peak) return;\n    const o = context.createOscillator();\n    o.frequency.value = peak.center;\n    const g = context.createGain();\n    g.gain.value = peak.amplitude / 255;\n    g.gain.exponentialRampToValueAtTime(0.00001, context.currentTime + duration);\n    o.connect(g);\n    g.connect(context.destination);\n    o.start(0);\n    o.stop(duration);\n  });\n  setTimeout(() => context.close(), duration * 333);\n};\n","import { useEffect, useState } from 'react';\n\nexport const useVisibility = () => {\n  const [visible, setVisible] = useState(!document.hidden);\n\n  useEffect(() => {\n    const listener = () => {\n      if (visible === document.hidden) setVisible(!document.hidden);\n    };\n    window.addEventListener('visibilitychange', listener);\n    return () => window.removeEventListener('visibilitychange', listener);\n  }, [visible]);\n\n  return visible;\n};\n","interface StorageItem {\n  expiration: number;\n  value: any;\n}\n\ninterface DataStore {\n  [prop: string]: StorageItem;\n}\n\nlet memoryStore: DataStore = {};\n\nconst USE_LOCAL_STORE = typeof localStorage !== 'undefined';\nconst LOCAL_STORE_KEY = 'PIANO-TUNING-DATA-STORE';\nconst VALUE_EXPIRATION = 14 * 24 * 60 * 60 * 1000;\nconst EXPIRATION_CHECK_INTERVAL = 60 * 60 * 1000;\n\nlet lastExpirationCheck = 0;\nfunction checkForExpired() {\n  if (Date.now() < lastExpirationCheck + EXPIRATION_CHECK_INTERVAL) return;\n  const store = getStore();\n  Object.keys(store).forEach(key => {\n    if (store[key].expiration < Date.now()) delete store[key];\n  });\n  setStore(store);\n  lastExpirationCheck = Date.now();\n}\n\nfunction getStore(): DataStore {\n  if (USE_LOCAL_STORE) {\n    const dataStr = localStorage.getItem(LOCAL_STORE_KEY);\n    if (dataStr) return JSON.parse(dataStr);\n  }\n  return memoryStore;\n}\n\nfunction setStore(value: DataStore) {\n  memoryStore = value;\n  if (USE_LOCAL_STORE) {\n    localStorage.setItem(LOCAL_STORE_KEY, JSON.stringify(value));\n  }\n}\n\nfunction set(key: string, value: any, expiration = VALUE_EXPIRATION) {\n  const store = getStore();\n  store[key] = {\n    expiration: Date.now() + expiration,\n    value,\n  };\n  setStore(store);\n  return value;\n}\n\nfunction get(key: string) {\n  const data = getStore()[key];\n  if (!data) return;\n  if (data.expiration < Date.now()) return clear(key);\n  return data.value;\n}\n\nfunction clear(key: string) {\n  const data = getStore();\n  delete data[key];\n  setStore(data);\n}\n\nexport const storageService = { set, get, clear, checkForExpired };\n","// sample rate = samples / second\n// fq = modulation / second\n// k = samples / modulation\n// --> fq = sample rate / k = samples / second / ( samples / modulation ) = modulations / second\n\nimport { findPeaks } from './findPeaks';\n\nexport const autoCorrelate = function (buffer: Uint8Array, sampleRate: number, minFq = 20, maxFq = 5000) {\n  let data: number[] = [];\n  const minK = Math.floor(sampleRate / maxFq) - 1;\n  const maxK = Math.ceil(sampleRate / minFq) + 1;\n  let n = buffer.length - maxK;\n\n  let bestR = 0;\n  let worstR = 1;\n  let bestK = -1;\n\n  // loop over all possible frequencies we want to test\n  // k = 8      --> 44100 / 8     = 5,512 hz (C8 = 4186.01hz)\n  // k = 2000   --> 44100 / 2000  = 22 hz (A0 = 27.5)\n  for (var k = minK; k < maxK; k++) {\n    let sum = 0;\n\n    n = buffer.length - k;\n    for (let i = 0; i < n; i++) {\n      const v1 = (buffer[i] - 128) / 128;\n      const v2 = (buffer[i + k] - 128) / 128;\n      sum += v1 * v2;\n      // sum +=  (v1-v2) * (v1-v2);\n    }\n\n    // const r = sum / (n + k);\n    const r = sum / n;\n    // const r = sum;\n\n    data.push(r);\n\n    if (r < worstR) worstR = r;\n\n    if (r > bestR) {\n      bestR = r;\n      bestK = k;\n    }\n  }\n\n  return data.map((r, k) => ({\n    r: (r - worstR) / (bestR - worstR),\n    k: k / bestK,\n    fq: sampleRate / (k + minK),\n  }));\n};\n\nexport const findFundamentalFqUsingAutocorrelation = function (\n  timeData: Uint8Array,\n  sampleRate: number,\n  minFq = 20,\n  maxFq = 5000,\n) {\n  const autocorrelation = autoCorrelate(timeData, sampleRate, minFq, maxFq);\n\n  const autoPeaks = findPeaks(\n    autocorrelation.map(a => a.r),\n    0.9,\n  );\n\n  // adjust peaks so that they correspond to the frequency, not the index\n  const autoPeaksFq = autoPeaks.map(peak => {\n    const idx = Math.floor(peak.center);\n    const dist = peak.center - idx;\n    const fq1 = autocorrelation[idx]?.fq;\n    const fq2 = autocorrelation[idx + 1]?.fq || fq1;\n    return { amplitude: peak.amplitude, center: fq1 * (1 - dist) + fq2 * dist };\n  });\n\n  let largestPeakFq = 0;\n  let largestPeakAmp = 0;\n\n  autoPeaksFq.forEach(peak => {\n    if (peak.amplitude > largestPeakAmp * 1.05) {\n      largestPeakAmp = peak.amplitude;\n      largestPeakFq = peak.center;\n    }\n  });\n\n  return {\n    autocorrelation,\n    autoPeaksFq,\n    largestPeakFq,\n  };\n};\n","import React from 'react';\n\nexport function downloadObjectAsJson(exportObj: any, exportName: string) {\n  const dataStr = 'data:text/json;charset=utf-8,' + encodeURIComponent(JSON.stringify(exportObj));\n  var downloadAnchorNode = document.createElement('a');\n  downloadAnchorNode.setAttribute('href', dataStr);\n  downloadAnchorNode.setAttribute('download', exportName);\n  document.body.appendChild(downloadAnchorNode); // required for firefox\n  downloadAnchorNode.click();\n  downloadAnchorNode.remove();\n}\n\nexport function uploadJsonProps(cb: { (obj: any): unknown }) {\n  return {\n    type: 'file',\n    onChange: (e: React.ChangeEvent<HTMLInputElement>) => {\n      let files = e.target.files;\n      if (!files?.length) return;\n      const file = files[0];\n      let reader = new FileReader();\n      reader.onload = e => {\n        const file = e.target?.result;\n        cb(JSON.parse(file as string));\n      };\n      reader.readAsText(file);\n    },\n  };\n}\n","export const mean = (list: number[] | Uint8Array) => {\n  let total = 0;\n  list.forEach((a: number) => (total += a));\n  total /= list.length;\n  return total;\n};\n\nexport const max = (list: number[] | Uint8Array) => {\n  let highest: number | null = null;\n  list.forEach((a: number) => {\n    if (highest === null || a > highest) highest = a;\n  });\n  return highest;\n};\n","import { useRef, useState } from 'react';\n\nimport './App.css';\nimport { CanvasChart, useCanvasChart } from './components/chart';\nimport { Piano } from './components/piano';\nimport config from './config';\nimport { BrowserAudio } from './utils/browserAudio';\nimport { approximateMissingHarmonics, extractHarmonics } from './utils/extractHarmonics';\nimport { findPeaks, Peak } from './utils/findPeaks';\nimport { KEYS } from './utils/keys';\nimport { generateHarmonics } from './utils/predictHarmonics';\nimport { findFundamentalFqUsingTwoWayMismatch } from './utils/twoWayMismatchAlgo';\nimport { useAnimate } from './utils/useAnimate';\nimport { ZScoreBoundary } from './utils/zScore';\nimport { useKeyboard } from './utils/useKeyboard';\nimport { CENTS1, CENTS100 } from './utils/constants';\nimport {\n  compareKeys,\n  generateTunedUsingFifths,\n  generateTunedUsingNoCurve,\n  generateTunedUsingTotalEntropy,\n} from './utils/entropy';\nimport { generateGradient } from './utils/colorGradient';\nimport { playNote } from './utils/playNote';\nimport { usePolling } from './utils/usePolling';\nimport { storageService } from './utils/storageService';\nimport { deepCopy } from './utils/deepCopy';\nimport { findFundamentalFqUsingAutocorrelation } from './utils/autocorrelation';\nimport { downloadObjectAsJson, uploadJsonProps } from './utils/jsonIO';\nimport { max, mean } from './utils/stat';\n\ninterface PianoKeysData {\n  [key: number]: {\n    key: number;\n    score: number;\n    fundamentalFq: number;\n    fundamentalFqTWM: number;\n    fundamentalFqAutocorr: number;\n    harmonics: (Peak | null)[];\n  };\n}\n\nlet recordedHarmonics: PianoKeysData = storageService.get('recordedHarmonics') || {};\nlet tunedHarmonics: PianoKeysData = storageService.get('tunedHarmonics') || {};\n\nconst colorGradient = generateGradient('00FF00', 'FF0000', 100);\n\nconst defaultSettings = {\n  mode: 'recording' as 'tuning' | 'recording',\n  noteSounds: {\n    harmonics: 'tuned' as 'recorded' | 'tuned',\n    notes: [] as number[],\n  },\n  tuning: {\n    curve: 'entropy' as 'none' | 'copy' | '7,12' | 'entropy',\n  },\n  transition: {\n    auto: 'next' as 'none' | 'next',\n  },\n  hiddenCharts: [] as string[],\n};\n\nfunction App() {\n  const audioRef = useRef<BrowserAudio>();\n  const lastValues = useRef({\n    autoChange: 0,\n    volume: [] as number[],\n    lastReset: 0,\n  });\n  const settingsRef = useRef<typeof defaultSettings>(storageService.get('tuningSettings') || defaultSettings);\n  const pianoKeyRef = useRef(0);\n  const [pianoKey, _setPianoKey] = useState(0); // currently focused key\n  const setPianoKey = (val: number) => {\n    const harmonics = settingsRef.current.noteSounds.harmonics === 'recorded' ? recordedHarmonics : tunedHarmonics;\n    const notes = settingsRef.current.noteSounds.notes;\n    if (notes.indexOf(0) !== -1) playNote(harmonics?.[val]?.harmonics);\n    if (notes.indexOf(notes[4]) !== -1 && val + 4 < 88) playNote(harmonics?.[val + 4]?.harmonics); // third\n    if (notes.indexOf(notes[7]) !== -1 && val + 7 < 88) playNote(harmonics?.[val + 7]?.harmonics); // fifth\n    if (notes.indexOf(notes[12]) !== -1 && val + 12 < 88) playNote(harmonics?.[val + 12]?.harmonics); // octave\n    if (notes.indexOf(notes[24]) !== -1 && val + 24 < 88) playNote(harmonics?.[val + 24]?.harmonics); // double  octave\n    _setPianoKey(val);\n    pianoKeyRef.current = val;\n  };\n  useKeyboard('ArrowLeft', () => {\n    if (pianoKey > 0) setPianoKey(pianoKey - 1);\n  });\n  useKeyboard('ArrowRight', () => {\n    if (pianoKey < 87) setPianoKey(pianoKey + 1);\n  });\n  usePolling(() => {\n    const storedRecordedHarmonics = JSON.stringify(storageService.get('recordedHarmonics'));\n    if (storedRecordedHarmonics !== JSON.stringify(recordedHarmonics)) {\n      storageService.set('recordedHarmonics', recordedHarmonics);\n    }\n\n    const storedTunedHarmonics = JSON.stringify(storageService.get('tunedHarmonics'));\n    if (storedTunedHarmonics !== JSON.stringify(tunedHarmonics)) {\n      storageService.set('tunedHarmonics', tunedHarmonics);\n    }\n\n    const storedSettings = JSON.stringify(storageService.get('tuningSettings'));\n    if (storedSettings !== JSON.stringify(settingsRef.current)) {\n      storageService.set('tuningSettings', settingsRef.current);\n    }\n  }, 60 * 1000);\n  const [, _rerender] = useState(0);\n  const rerender = () => _rerender(a => a + 1);\n\n  // highlight played keys with harmonic errors\n  const keyErrorStyles: { [key: number]: any } = {};\n  (() => {\n    const harmonics = settingsRef.current.noteSounds.harmonics === 'recorded' ? recordedHarmonics : tunedHarmonics;\n    const notes = settingsRef.current.noteSounds.notes;\n\n    const keyErrors: { [key: number]: number | null } = {};\n    const currKey = harmonics[pianoKey];\n    if (!currKey) return;\n    for (let key = 0; key < 88; key++) {\n      if (notes.indexOf(Math.abs(harmonics?.[key]?.key || 0 - currKey.key)) === -1) continue;\n      const err = compareKeys(currKey, harmonics[key]);\n      if (err !== null) {\n        keyErrors[key] = err;\n        const normErr = Math.floor(Math.min(99, err * 10));\n        keyErrorStyles[key + 1] = {\n          fill: `#${colorGradient[normErr]}`,\n        };\n      }\n    }\n  })();\n\n  const chartWidth = Math.min(window.innerWidth - 2, 1024);\n  const chartHeight = Math.min((chartWidth / 1024) * 300, 150);\n\n  const fftChart = useCanvasChart({\n    domain: {\n      x1: 0,\n      x2: 4500,\n      y1: 255,\n      y2: 0,\n    },\n    width: chartWidth,\n    height: chartHeight,\n  });\n  const focusedFftChart = useCanvasChart({\n    domain: {\n      x1: 1 / CENTS100,\n      x2: CENTS100,\n      y1: 255,\n      y2: 0,\n    },\n    width: chartWidth,\n    height: chartHeight,\n  });\n  const predictionChart = useCanvasChart({\n    domain: {\n      x1: -2,\n      x2: 104,\n      y1: 1,\n      y2: 0,\n    },\n    width: chartWidth,\n    height: chartHeight,\n  });\n  const autocorrelationChart = useCanvasChart({\n    domain: {\n      x1: 0,\n      x2: 4500,\n      y1: 1,\n      y2: 0,\n    },\n    width: chartWidth,\n    height: chartHeight,\n  });\n  const harmonicsChart = useCanvasChart({\n    domain: {\n      x1: -1,\n      x2: 50,\n      y1: 2,\n      y2: 0.8,\n    },\n    width: chartWidth,\n    height: chartHeight,\n  });\n  const tunningCurveChart = useCanvasChart({\n    domain: {\n      x1: -1,\n      x2: 88,\n      y1: 1 * CENTS100,\n      y2: 1 / CENTS100,\n    },\n    width: chartWidth,\n    height: chartHeight,\n  });\n\n  const chartVisible = (name: string) => (settingsRef.current.hiddenCharts?.indexOf(name) ?? -1) === -1;\n  const toggleChart = (name: string) => {\n    const idx = settingsRef.current.hiddenCharts.indexOf(name);\n    if (idx === -1) settingsRef.current.hiddenCharts.push(name);\n    else settingsRef.current.hiddenCharts.splice(idx, 1);\n    rerender();\n  };\n\n  useAnimate(() => {\n    const selectedKeyDef = KEYS[pianoKeyRef.current];\n\n    fftChart.clear();\n    focusedFftChart.clear();\n    predictionChart.clear();\n    harmonicsChart.clear();\n    tunningCurveChart.clear();\n    autocorrelationChart.clear();\n\n    // draw the recorded harmonics for the current key\n    (() => {\n      const tunedFundamentalFq = tunedHarmonics[pianoKeyRef.current]?.fundamentalFq || 0;\n      const recorededFundamentalFq = recordedHarmonics[pianoKeyRef.current]?.fundamentalFq || 0;\n\n      harmonicsChart.line({\n        x1: 0,\n        x2: 49,\n        y1: 1,\n        y2: 1,\n      });\n\n      harmonicsChart.line(\n        {\n          x1: 0,\n          x2: 49,\n          y1: (tunedFundamentalFq || recorededFundamentalFq) / selectedKeyDef.hz,\n          y2: (tunedFundamentalFq || recorededFundamentalFq) / selectedKeyDef.hz,\n        },\n        'red',\n      );\n\n      harmonicsChart.text({ x: 0, y: 1.9 }, `${selectedKeyDef.name} (${Math.round(selectedKeyDef.hz * 100) / 100})`);\n\n      if (recorededFundamentalFq)\n        harmonicsChart.text({ x: 0, y: 1.8 }, `Recorded (${Math.round(recorededFundamentalFq * 100) / 100})`);\n      if (tunedFundamentalFq)\n        harmonicsChart.text({ x: 0, y: 1.7 }, `Tuned (${Math.round(tunedFundamentalFq * 100) / 100})`, 'red');\n\n      // draw the peaks on the main FFT\n      (tunedHarmonics[pianoKeyRef.current]?.harmonics || recordedHarmonics[pianoKeyRef.current]?.harmonics)?.forEach(\n        (harmonic, idx) => {\n          if (!harmonic) return;\n          fftChart.line(\n            {\n              x1: harmonic.center,\n              x2: harmonic.center,\n              y1: 0,\n              y2: harmonic.amplitude,\n            },\n            'green',\n          );\n        },\n      );\n\n      // draw the recorded harmonic peaks\n      recordedHarmonics[pianoKeyRef.current]?.harmonics?.forEach((harmonic, idx) => {\n        if (!harmonic) return;\n        harmonicsChart.circle(\n          { x: idx, y: harmonic.center / selectedKeyDef.hz / (idx + 1) },\n          5,\n          `rgb(0 0 0 / ${Math.round(Math.min(100, (harmonic.amplitude + 30) / 2.55))}%)`,\n        );\n      });\n\n      // draw the tuned harmonic peaks\n      tunedHarmonics[pianoKeyRef.current]?.harmonics?.forEach((harmonic, idx) => {\n        if (!harmonic) return;\n        const fq = harmonic.center / selectedKeyDef.hz / (idx + 1);\n        harmonicsChart.line({ x1: idx - 0.5, x2: idx + 0.5, y1: fq, y2: fq }, `red`);\n      });\n    })();\n\n    // draw the tuning curve for all notes\n    (() => {\n      KEYS.forEach((key, idx) => {\n        const harmonicsRecorded = recordedHarmonics[idx]?.harmonics;\n        const harmonicsTuned = tunedHarmonics[idx]?.harmonics;\n\n        if (recordedHarmonics?.[idx]) recordedHarmonics[idx].harmonics = approximateMissingHarmonics(harmonicsRecorded);\n        let fundamentalFq = recordedHarmonics?.[idx]?.fundamentalFq || harmonicsRecorded?.[0]?.center;\n        if (fundamentalFq) {\n          tunningCurveChart.circle({\n            x: idx,\n            y: fundamentalFq / key.hz,\n          });\n        }\n\n        if (tunedHarmonics?.[idx]) tunedHarmonics[idx].harmonics = approximateMissingHarmonics(harmonicsTuned);\n        fundamentalFq = tunedHarmonics?.[idx]?.fundamentalFq || harmonicsTuned?.[0]?.center;\n        if (fundamentalFq) {\n          tunningCurveChart.line(\n            {\n              x1: idx - 0.5,\n              x2: idx + 0.5,\n              y1: fundamentalFq / key.hz,\n              y2: fundamentalFq / key.hz,\n            },\n            'red',\n          );\n        }\n\n        if (idx === pianoKeyRef.current) {\n          tunningCurveChart.line(\n            {\n              x1: idx,\n              x2: idx,\n              y1: CENTS100,\n              y2: 1 / CENTS100,\n            },\n            'blue',\n          );\n        }\n      });\n      tunningCurveChart.line({\n        x1: 0,\n        x2: 87,\n        y1: 1,\n        y2: 1,\n      });\n    })();\n\n    const audio = audioRef.current;\n    if (!audio) return;\n    const fqData = audio.getFrequencyData();\n    const timeData = audio.getTimeData();\n    const bucketWidth = audio.sampleRate / audio.fftSize;\n    const zScore = ZScoreBoundary(fqData);\n    const peaks = findPeaks(fqData, zScore).map(peak => ({ ...peak, center: peak.center * bucketWidth }));\n\n    // Main FFT Drawing\n    (() => {\n      // draw the FFT\n      fqData.forEach((val, idx) => {\n        fftChart.rect({\n          x1: idx * bucketWidth,\n          x2: (idx + 1) * bucketWidth,\n          y1: 0,\n          y2: val,\n        });\n      });\n\n      // draw the floor\n      zScore.forEach((val, idx) => {\n        if (idx === 0) return;\n        fftChart.line(\n          {\n            x1: idx * bucketWidth,\n            x2: (idx + 1) * bucketWidth,\n            y1: zScore[idx - 1],\n            y2: val,\n          },\n          'blue',\n        );\n      });\n\n      // draw the peaks\n      peaks.forEach((peak, idx) => {\n        fftChart.circle({ x: peak.center, y: peak.amplitude }, 5, 'red');\n\n        fftChart.text(\n          { x: 4000, y: 245 - (idx + 1) * 10 },\n          `Peak: ${Math.round(peak.center * 10) / 10} (${Math.round(peak.amplitude)})`,\n        );\n      });\n\n      // find the median distance between peaks\n      const distBetweenPeaks: number[] = [];\n      for (let i = 0; i < peaks.length; i++) {\n        distBetweenPeaks.push(peaks[i].center - (peaks[i - 1]?.center || 0));\n      }\n      const medianDistance = distBetweenPeaks[Math.floor(distBetweenPeaks.length / 2)];\n      fftChart.text({ x: 4000, y: 245 }, `Med Dist: ${Math.round(medianDistance * 10) / 10}`);\n    })();\n\n    // focused FFT drawing\n    (() => {\n      const harmonics =\n        tunedHarmonics[pianoKeyRef.current]?.harmonics || recordedHarmonics[pianoKeyRef.current]?.harmonics;\n      const center = harmonics?.find(p => p?.amplitude === Math.max(...harmonics.map(p => p?.amplitude || 0)))?.center;\n      if (!center) return;\n\n      const currentFq = tunedHarmonics?.[pianoKeyRef.current]?.fundamentalFq || selectedKeyDef.hz;\n      const adjustmentFactor = currentFq / center;\n\n      fqData.forEach((val, idx) => {\n        focusedFftChart.rect({\n          x1: ((idx - 0.5) * bucketWidth) / center,\n          x2: ((idx + 0.5) * bucketWidth) / center,\n          y1: 0,\n          y2: val,\n        });\n      });\n\n      focusedFftChart.line({ x1: 1, x2: 1, y1: 0, y2: 255 }, 'red');\n\n      peaks.forEach((peak, idx) => {\n        focusedFftChart.line(\n          {\n            x1: peak.center / center,\n            x2: peak.center / center,\n            y1: 0,\n            y2: 255,\n          },\n          'green',\n        );\n      });\n\n      const closestPeak = peaks.length\n        ? peaks.reduce((a, b) => (Math.abs(center - a.center) < Math.abs(center - b.center) ? a : b))\n        : null;\n\n      focusedFftChart.text(\n        { x: 1.001 / CENTS100, y: 240 },\n        `${selectedKeyDef.name} (${Math.round(selectedKeyDef.hz * 100) / 100})`,\n      );\n      focusedFftChart.text(\n        { x: 1.001 / CENTS100, y: 220 },\n        `Focused: ${Math.round(center * adjustmentFactor * 100) / 100}`,\n        'red',\n      );\n      focusedFftChart.text(\n        { x: 1.001 / CENTS100, y: 200 },\n        `Peak: ${Math.round((closestPeak?.center || 0) * adjustmentFactor * 100) / 100}`,\n        'green',\n      );\n      focusedFftChart.text({ x: 1.001 / CENTS100, y: 180 }, `Harmonic Shown: ${Math.round(center * 100) / 100}`);\n    })();\n\n    // store some data\n    const predictNote = () => {\n      const closestNote = (fq: number) => {\n        let minDist = CENTS100;\n        let minKey: number | null = null;\n        KEYS.forEach(key => {\n          const keyDist = Math.abs(key.hz - fq) / key.hz;\n          if (keyDist < minDist) {\n            minDist = keyDist;\n            minKey = key.hz;\n          }\n        });\n        return minKey;\n      };\n      const distBetweenPeaks: number[] = [];\n      for (let i = 0; i < peaks.length; i++) {\n        distBetweenPeaks.push(peaks[i].center - (peaks[i - 1]?.center || 0));\n      }\n      const medianDistance = distBetweenPeaks[Math.floor(distBetweenPeaks.length / 2)];\n      const medianOutput = closestNote(medianDistance);\n\n      const volume = mean(fqData);\n      const zLevel = mean(zScore);\n      const maxVolume = max(fqData);\n\n      const { largestPeakFq } = findFundamentalFqUsingAutocorrelation(timeData, audio.sampleRate, 20, 5000);\n      const autoCorrOutput = closestNote(largestPeakFq);\n\n      const maxPeak = peaks.find(p => p.amplitude === Math.max(...peaks.map(p => p.amplitude)))?.center || 0;\n      const maxPeakOutput = closestNote(maxPeak);\n\n      const peakCount = peaks.length;\n\n      let result: number | null = null;\n\n      if (!result && medianOutput && medianOutput === autoCorrOutput && medianOutput === maxPeakOutput) {\n        // peaks count above 10 is not possible for fq above 600hz\n        if (peakCount < 10 || medianOutput < 600) result = medianOutput;\n      }\n      // autocorrelation is accurate up to about 2500hz\n      if (!result && autoCorrOutput && autoCorrOutput < 2500) {\n        if (peakCount < 10 || autoCorrOutput < 600) result = autoCorrOutput;\n      }\n\n      // median distance between peaks gives a good approximation of what note we are hearing\n      // - after about 1500hz starts showing problems since there is a lower harmonic at play\n      if (!result && medianOutput && medianOutput < 1500) {\n        if (peakCount < 10 || medianOutput < 600) result = medianOutput;\n      }\n      // max peak is accurate for notes actually above 1000hz\n      //  - but has a few problems with notes below that having harmonics up to about 2000hz\n      if (!result && maxPeakOutput && maxPeakOutput > 2000) {\n        if (peakCount < 10) result = maxPeakOutput;\n      }\n\n      (window as any).timelineData = (window as any).timelineData || [];\n      (window as any).timelineData.push(\n        `${volume},${maxVolume},${zLevel},${peakCount},${medianOutput},${autoCorrOutput},${maxPeakOutput},${result},${pianoKeyRef.current}`,\n      );\n\n      return result;\n    };\n    if (2 < 1) predictNote();\n\n    // draw the autocorrelation\n    (() => {\n      const currentFq =\n        tunedHarmonics?.[pianoKeyRef.current]?.fundamentalFqAutocorr ||\n        tunedHarmonics?.[pianoKeyRef.current]?.fundamentalFq ||\n        selectedKeyDef.hz;\n      const adjustmentFactor =\n        tunedHarmonics[pianoKeyRef.current]?.fundamentalFq /\n          (tunedHarmonics?.[pianoKeyRef.current]?.fundamentalFqAutocorr || 0) || 1;\n\n      const minFq = currentFq / CENTS100;\n      const maxFq = currentFq * CENTS100;\n\n      const { autocorrelation, largestPeakFq } = findFundamentalFqUsingAutocorrelation(\n        timeData,\n        audio.sampleRate,\n        minFq,\n        maxFq,\n      );\n\n      autocorrelationChart.setDomain({ x1: minFq, x2: maxFq, y1: 1, y2: 0 });\n      for (let i = 1; i < autocorrelation.length; i++) {\n        autocorrelationChart.rect({\n          x1: autocorrelation[i - 1].fq,\n          x2: autocorrelation[i].fq,\n          y1: 0,\n          y2: autocorrelation[i - 1].r,\n        });\n      }\n      autocorrelationChart.line({ x1: currentFq, x2: currentFq, y1: 0, y2: 1 }, 'red');\n      autocorrelationChart.line({ x1: largestPeakFq, x2: largestPeakFq, y1: 0, y2: 1 }, 'green');\n      autocorrelationChart.text(\n        { x: currentFq / CENTS100, y: 0.9 },\n        `${selectedKeyDef.name} (${Math.round(selectedKeyDef.hz * 100) / 100})`,\n      );\n      autocorrelationChart.text(\n        { x: currentFq / CENTS100, y: 0.8 },\n        `Focused: ${Math.round(currentFq * adjustmentFactor * 100) / 100}`,\n        'red',\n      );\n      autocorrelationChart.text(\n        { x: currentFq / CENTS100, y: 0.7 },\n        `Peak: ${Math.round(largestPeakFq * adjustmentFactor * 10) / 10}`,\n        'green',\n      );\n    })();\n\n    // extract and record the harmonics\n    (() => {\n      const extractHarmonicsForKey = (key: number) => {\n        const targetFq = KEYS[key].hz;\n        const extracted = extractHarmonics(peaks, targetFq);\n        return extracted;\n      };\n      const recordHarmonicsForKey = (key: number, extracted: ReturnType<typeof extractHarmonicsForKey>) => {\n        const targetFq = KEYS[key].hz;\n        if (extracted.score > (recordedHarmonics[key]?.score || 0)) {\n          // get two way mismatch fq\n          const stepSize = targetFq * (CENTS1 - 1);\n          const lowFq = targetFq - stepSize * 50;\n          const highFq = targetFq + stepSize * 50;\n          const maxFq = peaks[peaks.length - 1].center;\n          let { peakCenterFq } = findFundamentalFqUsingTwoWayMismatch({\n            lowFq,\n            highFq,\n            stepSize,\n            targetHarmonics: generateHarmonics(targetFq, Math.round(maxFq / targetFq), 0.00055),\n            peaks,\n          });\n          // get autocorrelation fq\n          const { largestPeakFq } = findFundamentalFqUsingAutocorrelation(\n            timeData,\n            audio.sampleRate,\n            targetFq / CENTS100,\n            targetFq * CENTS100,\n          );\n          // fill in holes\n          const harmonics = approximateMissingHarmonics(extracted.harmonics);\n          let fundamentalFq = peakCenterFq;\n          if (fundamentalFq <= lowFq * 1.1 || fundamentalFq >= highFq * 0.9) fundamentalFq = harmonics[0]?.center || 0;\n          recordedHarmonics[key] = {\n            ...extracted,\n            harmonics,\n            fundamentalFq,\n            fundamentalFqTWM: peakCenterFq,\n            fundamentalFqAutocorr: largestPeakFq,\n            key,\n          };\n        }\n      };\n\n      const curNote = extractHarmonicsForKey(pianoKeyRef.current);\n\n      // if in tuning mode, reset the harmonics extracted each key press\n      const volume = max(fqData) || 0;\n      if (\n        settingsRef.current.mode === 'tuning' &&\n        mean(lastValues.current.volume) < 10 &&\n        volume > 50 &&\n        Date.now() - lastValues.current.lastReset > 2000 &&\n        curNote.score > (recordedHarmonics[pianoKeyRef.current]?.score || 0) * 0.5\n      ) {\n        delete recordedHarmonics[pianoKeyRef.current];\n        lastValues.current.lastReset = Date.now();\n      }\n      lastValues.current.volume.push(volume);\n      if (lastValues.current.volume.length > 10) lastValues.current.volume.shift();\n\n      recordHarmonicsForKey(pianoKeyRef.current, curNote);\n\n      if (settingsRef.current.transition.auto === 'next' && pianoKeyRef.current < 87) {\n        const nextNote = extractHarmonicsForKey(pianoKeyRef.current + 1);\n        if (nextNote.score > curNote.score && Date.now() - lastValues.current.autoChange > 2000) {\n          lastValues.current.autoChange = Date.now();\n          recordHarmonicsForKey(pianoKeyRef.current + 1, nextNote);\n          setPianoKey(pianoKeyRef.current + 1);\n        }\n      }\n    })();\n\n    // two way mismatch algo drawing\n    (() => {\n      if (peaks.length) {\n        const maxFq = peaks[peaks.length - 1].center;\n\n        // two way mismatch on current key +- 50 cents\n\n        const targetHarmonics = (tunedHarmonics[pianoKeyRef.current]?.harmonics ||\n          // recordedHarmonics[pianoKeyRef.current]?.harmonics ||\n          generateHarmonics(selectedKeyDef.hz, Math.round(maxFq / selectedKeyDef.hz), 0.00055)) as Peak[];\n        const currentFq =\n          tunedHarmonics[pianoKeyRef.current]?.harmonics?.[0]?.center ||\n          // recordedHarmonics[pianoKeyRef.current]?.fundamentalFq ||\n          selectedKeyDef.hz;\n        const stepSize = currentFq * (CENTS1 - 1);\n\n        // since we adjust based on the first harmonic, but the other displayed values are the fundemantal frequency\n        const adjustmentFactor =\n          tunedHarmonics[pianoKeyRef.current]?.fundamentalFq /\n            (tunedHarmonics[pianoKeyRef.current]?.harmonics?.[0]?.center || 1) || 1;\n        // console.log(\n        //   tunedHarmonics[pianoKeyRef.current]?.fundamentalFq,\n        //   tunedHarmonics[pianoKeyRef.current]?.harmonics?.[0]?.center,\n        // );\n\n        const { prediction, maxPeak, peakCenterFq } = findFundamentalFqUsingTwoWayMismatch({\n          lowFq: currentFq - stepSize * 50,\n          highFq: currentFq + stepSize * 50,\n          stepSize,\n          targetHarmonics,\n          peaks,\n        });\n        // console.log(prediction);\n\n        prediction.forEach((weight, idx) => {\n          predictionChart.rect({ x1: idx - 0.5, x2: idx + 0.5, y1: 0, y2: weight });\n        });\n        predictionChart.line({ x1: maxPeak?.center || 0, x2: maxPeak?.center || 0, y1: 0, y2: 1 }, 'green');\n        predictionChart.line({ x1: 50, x2: 50, y1: 0, y2: 1 }, 'red');\n        predictionChart.text({ x: 0, y: 0.9 }, `${selectedKeyDef.name} (${Math.round(selectedKeyDef.hz * 100) / 100})`);\n        predictionChart.text(\n          { x: 0, y: 0.8 },\n          `Focused: ${Math.round(currentFq * adjustmentFactor * 100) / 100}`,\n          'red',\n        );\n        predictionChart.text(\n          { x: 0, y: 0.7 },\n          `Peak: ${Math.round(peakCenterFq * adjustmentFactor * 100) / 100}`,\n          'green',\n        );\n      }\n    })();\n  });\n\n  return (\n    <div className='App'>\n      {!audioRef.current ? (\n        <button\n          style={{\n            background: '#37c53c',\n            color: '#fff',\n            margin: 20,\n            border: '1px solid green',\n          }}\n          onClick={() => {\n            audioRef.current = new BrowserAudio({\n              fftSize: config('fftSize'),\n              minDecibels: config('minDecibels'),\n              maxDecibels: config('maxDecibels'),\n            });\n            rerender();\n          }}\n        >\n          Start Listening\n        </button>\n      ) : (\n        <button\n          style={{\n            background: '#f44336',\n            color: '#fff',\n            margin: 20,\n            border: '1px solid #a92319',\n          }}\n          onClick={() => {\n            audioRef.current = undefined;\n            rerender();\n          }}\n        >\n          Stop Listening\n        </button>\n      )}\n\n      <div style={{ overflowX: 'auto', overflowY: 'hidden', height: 150 }}>\n        <Piano onClick={setPianoKey} notes={[KEYS[pianoKey]]} keyStyles={keyErrorStyles} />\n      </div>\n\n      <div>\n        Mode\n        <select\n          value={settingsRef.current.mode}\n          onChange={e => {\n            settingsRef.current.mode = e.target.value as any;\n          }}\n        >\n          <option value='recording'>Recording</option>\n          <option value='tuning'>Tuning</option>\n        </select>\n        <select\n          value={settingsRef.current.transition.auto}\n          onChange={e => {\n            settingsRef.current.transition.auto = e.target.value as any;\n          }}\n        >\n          <option value='none'>Auto Transition Disabled</option>\n          <option value='next'>Auto Transition To Next Note</option>\n        </select>\n      </div>\n      <div>\n        Recorded\n        <button onClick={() => downloadObjectAsJson(recordedHarmonics, 'recorded.json')}>Download</button>\n        <input className='fileInput' {...uploadJsonProps(data => (recordedHarmonics = data))} />\n        <button onClick={() => delete recordedHarmonics[pianoKey]}>Clear Current</button>\n        <button onClick={() => (recordedHarmonics = {})}>Clear All</button>\n      </div>\n      <div>\n        Tuned\n        <button onClick={() => downloadObjectAsJson(tunedHarmonics, 'tuned.json')}>Download</button>\n        <input className='fileInput' {...uploadJsonProps(data => (tunedHarmonics = data))} />\n        <button onClick={() => (tunedHarmonics = {})}>Clear All</button>\n      </div>\n      <div>\n        Sounds\n        <select\n          value={JSON.stringify(settingsRef.current.noteSounds.notes)}\n          onChange={e => {\n            settingsRef.current.noteSounds.notes = JSON.parse(e.target.value);\n          }}\n        >\n          <option value='[]'>No Sounds</option>\n          <option value='[0]'>Note Only</option>\n          <option value='[0,4]'>Note + Third</option>\n          <option value='[0,7]'>Note + Fifth</option>\n          <option value='[0,12]'>Note + Octave</option>\n          <option value='[0,24]'>Note + Double Octave</option>\n          <option value='[0,4,7]'>Note + Third + Fifth</option>\n          <option value='[0,4,7,12]'>Note + Third + Fifth + Octave</option>\n          <option value='[0,12,24]'>Note + Octave + Double Octave</option>\n          <option value='[0,4,7,12,24]'>Note + All</option>\n        </select>\n        <select\n          value={settingsRef.current.noteSounds.harmonics}\n          onChange={e => {\n            settingsRef.current.noteSounds.harmonics = e.target.value as any;\n          }}\n        >\n          <option value='recorded'>Recorded Notes</option>\n          <option value='tuned'>Tuned Notes</option>\n        </select>\n      </div>\n      <div>\n        Tuning\n        <select\n          value={settingsRef.current.tuning.curve}\n          onChange={e => {\n            settingsRef.current.tuning.curve = e.target.value as any;\n          }}\n        >\n          <option value='none'>No Curve</option>\n          <option value='copy'>Same as Recorded</option>\n          <option value='7,12'>Tune With Fifths + Octaves</option>\n          <option value='entropy'>Tune With Entropy</option>\n        </select>\n        <button\n          onClick={() => {\n            const curve = settingsRef.current.tuning.curve;\n            if (curve === 'copy') tunedHarmonics = deepCopy(recordedHarmonics);\n            if (curve === 'none') tunedHarmonics = generateTunedUsingNoCurve(recordedHarmonics);\n            if (curve === '7,12') tunedHarmonics = generateTunedUsingFifths(recordedHarmonics);\n            if (curve === 'entropy') tunedHarmonics = generateTunedUsingTotalEntropy(recordedHarmonics);\n          }}\n        >\n          Generate Tuning Curve\n        </button>\n      </div>\n      <br />\n      <div className='chartTitle' onClick={() => toggleChart('fullFFT')}>\n        Full Spectrum FFT\n      </div>\n      <div className='chartContainer' style={{ height: chartVisible('fullFFT') ? chartHeight + 2 : 0 }}>\n        <CanvasChart {...fftChart} />\n      </div>\n      <div className='chartTitle' onClick={() => toggleChart('focusedFFT')}>\n        Focused FFT\n      </div>\n      <div className='chartContainer' style={{ height: chartVisible('focusedFFT') ? chartHeight + 2 : 0 }}>\n        <CanvasChart {...focusedFftChart} />\n      </div>\n      <div className='chartTitle' onClick={() => toggleChart('twm')}>\n        Two Way Mismatch\n      </div>\n      <div className='chartContainer' style={{ height: chartVisible('twm') ? chartHeight + 2 : 0 }}>\n        <CanvasChart {...predictionChart} />\n      </div>\n      <div className='chartTitle' onClick={() => toggleChart('autocorr')}>\n        Autocorrelation\n      </div>\n      <div className='chartContainer' style={{ height: chartVisible('autocorr') ? chartHeight + 2 : 0 }}>\n        <CanvasChart {...autocorrelationChart} />\n      </div>\n      <div className='chartTitle' onClick={() => toggleChart('harmonics')}>\n        Current Note Harmonics\n      </div>\n      <div className='chartContainer' style={{ height: chartVisible('harmonics') ? chartHeight + 2 : 0 }}>\n        <CanvasChart {...harmonicsChart} />\n      </div>\n      <div className='chartTitle' onClick={() => toggleChart('curve')}>\n        Tuning Curve\n      </div>\n      <div className='chartContainer' style={{ height: chartVisible('curve') ? chartHeight + 2 : 0 }}>\n        <CanvasChart {...tunningCurveChart} />\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","import { useEffect } from 'react';\nimport { useVisibility } from './useVisibility';\n\nexport const usePolling = (cb: () => any, interval = 1000) => {\n  const visible = useVisibility();\n  useEffect(() => {\n    if (!visible) return;\n    let timeout: number = 0;\n    let active = true;\n    const polling = async () => {\n      clearTimeout(timeout);\n      if (!active) return;\n      await cb();\n      timeout = window.setTimeout(polling, interval);\n    };\n    timeout = window.setTimeout(polling, 0);\n    return function cleanup() {\n      active = false;\n      clearTimeout(timeout);\n    };\n  }, [visible, cb, interval]);\n};\n","import { useEffect } from 'react';\n\nexport const useAnimate = (fn: { (): unknown }) => {\n  useEffect(() => {\n    let breakLoop = false;\n    const loop = () => {\n      if (breakLoop) return;\n      fn();\n      requestAnimationFrame(loop);\n    };\n    loop();\n    return () => {\n      breakLoop = true;\n    };\n  }, [fn]);\n  return;\n};\n","// needs fixing - uses rolling average efficiency gain\nexport function ZScoreBoundary(samples: Uint8Array) {\n  const lag = 60;\n  const threshold = 2.5;\n  const signals = new Uint8Array(samples.length);\n  const sumArr: number[] = [];\n  const sum2diffArr: number[] = [];\n  const binArr: number[] = [];\n\n  // i = index within the sample (sometimes too big or too small)\n  for (let i = -lag; i < samples.length + lag; i++) {\n    const firstSampleIdx = Math.max(0, i - lag);\n    const lastSampleIdx = Math.min(i + lag, samples.length - 1);\n    let bin = lastSampleIdx - firstSampleIdx + 1;\n\n    // keep last sum, add in val[i+lag] ahead and remove val[i-lag-1] behind\n    let sum = sumArr[i - 1 + lag] || 0;\n    if (i + lag < samples.length) sum += samples[i + lag];\n    if (i - lag - 1 >= 0) sum -= samples[i - lag - 1];\n    const avg = sum / bin;\n\n    let sum2diff = 0;\n    for (let j = firstSampleIdx; j <= lastSampleIdx; j++) {\n      sum2diff += Math.pow(samples[j] - avg, 2);\n    }\n\n    sumArr[i + lag] = sum;\n    sum2diffArr[i + lag] = sum2diff;\n    binArr[i + lag] = bin;\n\n    if (i < 0 || i > samples.length) continue;\n\n    let std = Math.pow(sum2diff / (bin - 1), 0.5);\n    std = Math.min(10, std);\n\n    signals[i] = Math.min(threshold * std + avg, 255);\n  }\n\n  // console.log(\n  //   sum2diffArr.map((v, i) => Math.pow(v / (binArr[i] - 1), 0.5)).join(\",\")\n  // );\n\n  return signals;\n}\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root'),\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"key\":\"piano_key__38M4z\",\"ivory\":\"piano_ivory__A0tOg\",\"ebony\":\"piano_ebony__3WXM6\",\"lit\":\"piano_lit__2Tqvo\"};"],"sourceRoot":""}